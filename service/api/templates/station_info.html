<h2 class="text-lg text-gray-800 text-left mb-4">Station info</h2>

{{with .Response.Info}}
<table id="station-summary" class="w-full table-auto border-collapse text-sm">
    <tbody>
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Station abbrev.
            </td>
            <td class="py-2 text-gray-800">
                {{.Station.Abbr}}
            </td>
        </tr>
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Station name
            </td>
            <td class="py-2 text-gray-800">
                {{.Station.Name}}
            </td>
        </tr>
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Canton
            </td>
            <td class="py-2 text-gray-800">
                {{.Station.Canton}}
            </td>
        </tr>
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Elevation
            </td>
            <td class="py-2 text-gray-800">
                {{float "%.0f" .Station.HeightMASL}} m a.s.l.
            </td>
        </tr>
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Exposition
            </td>
            <td class="py-2 text-gray-800">
                {{.Station.Exposition.EN}} (<em>de: {{.Station.Exposition.DE}}</em>)
            </td>
        </tr>
        {{if .Station.CoordinatesWGS84Lat.HasValue}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Long. / Lat. (WGS84)
            </td>
            <td class="py-2 text-gray-800">
                {{$lat := float "%.4f" .Station.CoordinatesWGS84Lat}}
                {{$lon := float "%.4f" .Station.CoordinatesWGS84Lon}}
                <a href="https://www.openstreetmap.org/?mlat={{$lat}}&mlon={{$lon}}#map=12/{{$lat}}/{{$lon}}"
                    target="_blank" class="text-blue-600 hover:underline inline-flex items-center">
                    {{$lon}} / {{$lat}}
                    <svg xmlns="http://www.w3.org/2000/svg" class="ml-1 w-4 h-4 inline" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M18 13v6a2 2 0 01-2 2H6a2 2 0 01-2-2V8a2 2 0 012-2h6m4-4h6m0 0v6m0-6L10 14" />
                    </svg>
                </a>
            </td>
        </tr>
        {{end}}
        <!-- Nearby stations -->
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Nearby stations
            </td>
            <td class="py-2 text-gray-800">
                {{range $i, $s := first 3 .NearbyStations}}
                    {{if gt $i 0}}• {{end}}

                    <a href="/ui/map?station={{$s.Abbr}}" class="text-blue-600 hover:underline">
                        {{$s.Name}} {{$s.Canton}}</a> ({{printf "%.1f" $s.DistanceKm}} km)
                {{end}}
            </td>
        </tr>
        <!-- MeteoSwiss URL -->
        {{if .Station.URL.EN}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                MeteoSwiss
            </td>
            <td class="py-2 text-gray-800">
                <a href="{{.Station.URL.EN}}" target="_blank"
                    class="text-blue-600 hover:underline inline-flex items-center">
                    {{.Station.Abbr}}
                    <svg xmlns="http://www.w3.org/2000/svg" class="ml-1 w-4 h-4 inline" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M18 13v6a2 2 0 01-2 2H6a2 2 0 01-2-2V8a2 2 0 012-2h6m4-4h6m0 0v6m0-6L10 14" />
                    </svg>
                </a>
            </td>
        </tr>
        {{end}}
    </tbody>
</table>

{{ if false }}

<!-- TODO Re-enable once it's based on homogenous data. -->
<h2 class="text-lg text-gray-800 text-left mb-4 mt-8">Climate Normals statistics (1991 &ndash; 2020)</h2>

<p class="text-sm text-gray-600 leading-relaxed mb-4">
    The table below shows summary statistics for the <a class="text-blue-600 hover:underline"
        href="https://www.ncei.noaa.gov/products/wmo-climate-normals">WMO Climate Normals</a> period
    1991&ndash;2020. For average values the corresponding <a class="text-blue-600 hover:underline"
        href="https://en.wikipedia.org/wiki/Interquartile_range" target="_blank">interquartile range (IQR)</a>
    (the &laquo;middle 50%&raquo;) is shown in parentheses.
</p>

{{ template "norm9120_stats.html" . }}

{{ end }}

<!-- Data availability -->
<h2 class="text-lg text-gray-800 text-left mb-4 mt-8">Data availability</h2>

<p class="text-sm text-gray-600 leading-relaxed mb-4">
    The table below shows for which date ranges daily measurements
    are available in this service's database. Coverage (<em>Cov. %</em>) should be ~ 100%;
    lower values indicate periods of missing data between 
    <em>First Date</em> and <em>Last Date</em>.
</p>

<div class="relative max-h-96 overflow-y-auto">

    <table id="station-measurement-infos" class="w-full table-auto border-collapse text-sm">
    <thead>
        <tr class="border-b">
        <th scope="col" class="py-2 pr-2 text-left text-gray-700">Dataset</th>
        <th scope="col" class="py-2 pr-2 text-left text-gray-700">Variable</th>
        <th scope="col" class="py-2 pr-2 text-left text-gray-700">Cov. %</th>
        <th scope="col" class="py-2 pr-2 text-left text-gray-700 whitespace-nowrap">First Date</th>
        <th scope="col" class="py-2 pr-2 text-left text-gray-700 whitespace-nowrap" >Last Date</th>
        <th scope="col" class="py-2 pr-2 text-left text-gray-700">Group</th>
        <th scope="col" class="py-2 pr-2 text-left text-gray-700">Description</th>
        </tr>    <tbody>
            {{range .DailyMeasurementInfos}}
            <tr class="border-b">
                <td class="py-2 pr-2 text-gray-800">
                    {{.Dataset}}
                </td>
                <td class="py-2 pr-2 text-gray-800">
                    {{.Variable}}
                </td>
                <td class="py-2 pr-2 text-gray-800">
                    {{printf "%.0f%%" .ValuePresentPercent}}
                </td>
                <td class="py-2 pr-2 text-gray-800">
                    {{datefmt "Y-m-d" .MinDate}}
                </td>
                <td class="py-2 pr-2 text-gray-800">
                    {{datefmt "Y-m-d" .MaxDate}}
                </td>
                <td class="py-2 pr-2 text-gray-800">
                    {{.Group.EN}}
                </td>
                <td class="py-2 text-gray-800">
                    {{.Description.EN}}
                </td>
            </tr>
            {{end}}
        </tbody>
    </table>    
</div>

{{end}}