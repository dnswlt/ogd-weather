<h2 class="text-lg text-gray-800 text-left mb-4">Station info</h2>

{{with .Response.Info}}
<table id="station-summary" class="w-full table-auto border-collapse text-sm">
    <tbody>
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Station abbrev.
            </td>
            <td class="py-2 text-gray-800">
                {{.Station.Abbr}}
            </td>
        </tr>
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Station name
            </td>
            <td class="py-2 text-gray-800">
                {{.Station.Name}}
            </td>
        </tr>
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Canton
            </td>
            <td class="py-2 text-gray-800">
                {{.Station.Canton}}
            </td>
        </tr>
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Elevation
            </td>
            <td class="py-2 text-gray-800">
                {{float "%.0f" .Station.HeightMASL}} m a.s.l.
            </td>
        </tr>
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Exposition
            </td>
            <td class="py-2 text-gray-800">
                {{.Station.Exposition.EN}} (<em>de: {{.Station.Exposition.DE}}</em>)
            </td>
        </tr>
        {{if .Station.CoordinatesWGS84Lat.HasValue}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Long. / Lat. (WGS84)
            </td>
            <td class="py-2 text-gray-800">
                {{$lat := float "%.4f" .Station.CoordinatesWGS84Lat}}
                {{$lon := float "%.4f" .Station.CoordinatesWGS84Lon}}
                <a href="https://www.openstreetmap.org/?mlat={{$lat}}&mlon={{$lon}}#map=12/{{$lat}}/{{$lon}}"
                    target="_blank" class="text-blue-600 hover:underline inline-flex items-center">
                    {{$lon}} / {{$lat}}
                    <svg xmlns="http://www.w3.org/2000/svg" class="ml-1 w-4 h-4 inline" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M18 13v6a2 2 0 01-2 2H6a2 2 0 01-2-2V8a2 2 0 012-2h6m4-4h6m0 0v6m0-6L10 14" />
                    </svg>
                </a>
            </td>
        </tr>
        {{end}}
        <!-- Nearby stations -->
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Nearby stations
            </td>
            <td class="py-2 text-gray-800">
                {{range $i, $s := first 3 .NearbyStations}}
                    {{if gt $i 0}}â€¢ {{end}}

                    <a href="/ui/map?station={{$s.Abbr}}" class="text-blue-600 hover:underline">
                        {{$s.Name}} {{$s.Canton}}</a> ({{printf "%.1f" $s.DistanceKm}} km)
                {{end}}
            </td>
        </tr>
        <!-- MeteoSwiss URL -->
        {{if .Station.URL.EN}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                MeteoSwiss
            </td>
            <td class="py-2 text-gray-800">
                <a href="{{.Station.URL.EN}}" target="_blank"
                    class="text-blue-600 hover:underline inline-flex items-center">
                    {{.Station.Abbr}}
                    <svg xmlns="http://www.w3.org/2000/svg" class="ml-1 w-4 h-4 inline" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M18 13v6a2 2 0 01-2 2H6a2 2 0 01-2-2V8a2 2 0 012-2h6m4-4h6m0 0v6m0-6L10 14" />
                    </svg>
                </a>
            </td>
        </tr>
        {{end}}
    </tbody>
</table>

<!-- TODO: proper padding for headings, this mt-4 mb-4 is a bit hacky. -->
<h2 class="text-lg text-gray-800 text-left mb-4 mt-8">Climate Normals statistics (1991 &ndash; 2020)</h2>

<p class="text-sm text-gray-600 leading-relaxed mb-4">
    The table below shows summary statistics for the <a class="text-blue-600 hover:underline"
        href="https://www.ncei.noaa.gov/products/wmo-climate-normals">WMO Climate Normals</a> period
    1991&ndash;2020. For average values the corresponding <a class="text-blue-600 hover:underline"
        href="https://en.wikipedia.org/wiki/Interquartile_range" target="_blank">interquartile range (IQR)</a>
    (the &laquo;middle 50%&raquo;) is shown in parentheses.
</p>

<table id="station-summary" class="w-full table-auto border-collapse text-sm">
    <tbody>
        {{with .Ref1991To2020Stats}}

        {{if .Vars.SourceDateRange}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Date range    
            </td>
            <td class="py-2 text-gray-800">
                {{datefmt "a J Y" .Vars.SourceDateRange.MinValueDate}} &ndash; 
                {{datefmt "a J Y" .Vars.SourceDateRange.MaxValueDate}}
            </td>
        </tr>
        {{end}}
        {{if .Vars.TemperatureDailyMin}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Lowest temperature
            </td>
            <td class="py-2 text-gray-800">
                {{printf "%.1f" .Vars.TemperatureDailyMin.MinValue}} &deg;C
                ({{datefmt "a J Y" .Vars.TemperatureDailyMin.MinValueDate}})
            </td>
        </tr>
        {{end}}
        {{if .Vars.TemperatureDailyMax}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Highest temperature
            </td>
            <td class="py-2 text-gray-800">
                {{printf "%.1f" .Vars.TemperatureDailyMax.MaxValue}} &deg;C
                ({{datefmt "a J Y" .Vars.TemperatureDailyMax.MaxValueDate}})
            </td>
        </tr>
        {{end}}
        {{if .Vars.PrecipitationDailyMillimeters}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Avg. daily rainfall
            </td>
            <td class="py-2 text-gray-800">
                {{printf "%.1f" .Vars.PrecipitationDailyMillimeters.MeanValue}} mm
                ({{printf "%.1f" .Vars.PrecipitationDailyMillimeters.P25Value}}
                &ndash;
                {{printf "%.1f" .Vars.PrecipitationDailyMillimeters.P75Value}} mm)
            </td>
        </tr>
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Highest daily rainfall
            </td>
            <td class="py-2 text-gray-800">
                {{printf "%.1f" .Vars.PrecipitationDailyMillimeters.MaxValue}} mm
                ({{datefmt "a J Y" .Vars.PrecipitationDailyMillimeters.MaxValueDate}})
            </td>
        </tr>
        {{end}}
        {{if .Vars.SunshineDailyMinutes}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Avg. daily sunshine
            </td>
            <td class="py-2 text-gray-800">
                {{min2hours .Vars.SunshineDailyMinutes.MeanValue}} hours
                ({{min2hours
                .Vars.SunshineDailyMinutes.P25Value}}
                &ndash;
                {{min2hours .Vars.SunshineDailyMinutes.P75Value}} h)
            </td>
        </tr>
        {{end}}
        {{if .Vars.AtmPressureDailyMean}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Avg. atmospheric pressure
            </td>
            <td class="py-2 text-gray-800">
                {{printf "%.0f" .Vars.AtmPressureDailyMean.MeanValue}} hPa
                ({{printf "%.1f" .Vars.AtmPressureDailyMean.P25Value}}
                &ndash;
                {{printf "%.1f" .Vars.AtmPressureDailyMean.P75Value}} hPa)
            </td>
        </tr>
        {{end}}
        {{if .Vars.GustPeakDailyMax}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Max. wind speed
            </td>
            <td class="py-2 text-gray-800">
                {{printf "%.1f" (ms2kmh .Vars.GustPeakDailyMax.MaxValue)}} km/h
                ({{datefmt "a J Y" .Vars.GustPeakDailyMax.MaxValueDate}})
            </td>
        </tr>
        {{end}}
        {{if .Vars.SummerDaysAnnualCount}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Avg. summer days (&geq; 25&deg;C)
            </td>
            <td class="py-2 text-gray-800">
                {{printf "%.0f" .Vars.SummerDaysAnnualCount.MeanValue}} days
                ({{printf "%.0f" .Vars.SummerDaysAnnualCount.P25Value}}
                &ndash;
                {{printf "%.0f" .Vars.SummerDaysAnnualCount.P75Value}} days)
            </td>
        </tr>
        {{end}}
        {{if .Vars.SunnyDaysAnnualCount}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Avg. sunny days (&geq; 6 h sunshine)
            </td>
            <td class="py-2 text-gray-800">
                {{printf "%.0f" .Vars.SunnyDaysAnnualCount.MeanValue}} days
                ({{printf "%.0f" .Vars.SunnyDaysAnnualCount.P25Value}}
                &ndash;
                {{printf "%.0f" .Vars.SunnyDaysAnnualCount.P75Value}} days)
            </td>
        </tr>
        {{end}}
        {{if .Vars.TropicalNightsAnnualCount}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Avg. no. of tropical nights (&ge; 20&deg;C)
            </td>
            <td class="py-2 text-gray-800">
                {{printf "%.1f" .Vars.TropicalNightsAnnualCount.MeanValue}} nights
                ({{printf "%.1f" .Vars.TropicalNightsAnnualCount.P25Value}}
                &ndash;
                {{printf "%.1f" .Vars.TropicalNightsAnnualCount.P75Value}} nights)
            </td>
        </tr>
        {{if gt .Vars.TropicalNightsAnnualCount.MaxValue 0.05}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Max. tropical nights (&ge; 20&deg;C)
            </td>
            <td class="py-2 text-gray-800">
                {{printf "%.1f" .Vars.TropicalNightsAnnualCount.MaxValue}} nights
                ({{datefmt "Y" .Vars.TropicalNightsAnnualCount.MaxValueDate}})
            </td>
        </tr>
        {{end}}
        {{end}}
        {{if .Vars.FrostDaysAnnualCount}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Avg. frost days (&lt; 0&deg;C)
            </td>
            <td class="py-2 text-gray-800">
                {{printf "%.0f" .Vars.FrostDaysAnnualCount.MeanValue}} days
                ({{printf "%.0f" .Vars.FrostDaysAnnualCount.P25Value}}
                &ndash;
                {{printf "%.0f" .Vars.FrostDaysAnnualCount.P75Value}} days)
            </td>
        </tr>
        {{end}}
        {{if .Vars.GrowingDegreeDaysAnnualSum}}
        <tr class="border-b">
            <td class="py-2 pr-4 font-medium text-gray-600 whitespace-nowrap w-1">
                Avg. growing degree days
            </td>
            <td class="py-2 text-gray-800">
                {{printf "%.0f" .Vars.GrowingDegreeDaysAnnualSum.MeanValue}}
                <a class="text-blue-600 hover:underline" href="https://en.wikipedia.org/wiki/Growing_degree-day"
                    target="_blank">GDD</a>
                ({{printf "%.0f" .Vars.GrowingDegreeDaysAnnualSum.P25Value}}
                &ndash;
                {{printf "%.0f" .Vars.GrowingDegreeDaysAnnualSum.P75Value}})
            </td>
        </tr>
        {{end}}

        {{end}} <!-- {{/* with .Ref1991To2020Stats */}} -->
    </tbody>
</table>

<!-- Data availability -->
<h2 class="text-lg text-gray-800 text-left mb-4 mt-8">Data availability</h2>

<p class="text-sm text-gray-600 leading-relaxed mb-4">
    The table below shows for which date ranges daily measurements
    are available in this service's database. Coverage (<em>Cov. %</em>) should be ~ 100%;
    lower values indicate periods of missing data between 
    <em>First Date</em> and <em>Last Date</em>.
</p>

<table id="station-measurement-infos" class="w-full table-auto border-collapse text-sm">
<thead>
    <tr class="border-b">
      <th scope="col" class="py-2 pr-2 text-left text-gray-700">Variable</th>
      <th scope="col" class="py-2 pr-2 text-left text-gray-700">Cov. %</th>
      <th scope="col" class="py-2 pr-2 text-left text-gray-700 whitespace-nowrap">First Date</th>
      <th scope="col" class="py-2 pr-2 text-left text-gray-700 whitespace-nowrap" >Last Date</th>
      <th scope="col" class="py-2 pr-2 text-left text-gray-700">Group</th>
      <th scope="col" class="py-2 pr-2 text-left text-gray-700">Description</th>
    </tr>    <tbody>
        {{range .DailyMeasurementInfos}}
        <tr class="border-b">
            <td class="py-2 pr-2 text-gray-800">
                {{.Variable}}
            </td>
            <td class="py-2 pr-2 text-gray-800">
                {{printf "%.0f%%" .DailyValuePresentPercent}}
            </td>
            <td class="py-2 pr-2 text-gray-800">
                {{datefmt "Y-m-d" .MinDate}}
            </td>
            <td class="py-2 pr-2 text-gray-800">
                {{datefmt "Y-m-d" .MaxDate}}
            </td>
            <td class="py-2 pr-2 text-gray-800">
                {{.Group.EN}}
            </td>
            <td class="py-2 text-gray-800">
                {{.Description.EN}}
            </td>
        </tr>
        {{end}}
    </tbody>
</table>    

{{end}}