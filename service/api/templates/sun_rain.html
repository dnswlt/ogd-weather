<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Weather Data CH</title>

    <!-- Tailwind -->
    <link rel="stylesheet" href="/static/dist/main.css" />

    <!-- Vega stack -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

    <!-- htmx + path‑params -->
    <script src="https://unpkg.com/htmx.org@2.0.6"></script>
    <script src="https://unpkg.com/htmx-ext-path-params@2.0.0/path-params.js"></script>
</head>

<body class="min-h-screen bg-gray-50 p-4" data-page="sun_rain">
    <!-- Navbar -->
    {{template "nav.html" .}}

    <main class="w-full max-w-screen-lg mx-auto space-y-6 bg-white shadow rounded-xl p-6">
        <h1 class="text-2xl font-semibold text-center">Sunshine &amp; Rain</h1>

        <!-- Controls -->
        <form class="space-y-4" id="chart-controls">

            <!-- Station -->
            <div class="grid grid-cols-3 gap-3 items-center">
                <label for="station" class="col-span-1 font-medium">Station</label>

                <select id="station" name="station" class="col-span-2 border rounded p-2 w-full">
                    {{$selected := .Query.station}}
                    {{range .Stations}}
                    <option value="{{.Abbr}}" {{if eq .Abbr $selected}}selected{{end}}>{{.Name}} {{.Canton}} ({{.Abbr}})
                    </option>
                    {{end}}
                </select>
            </div>

            <!-- Period -->
            <div class="grid grid-cols-3 gap-3 items-center">
                <label for="period" class="col-span-1 font-medium">Period</label>

                <select id="period" name="period" class="col-span-2 border rounded p-2 w-full">
                    <!-- Jan Feb Mar ... Spring Summer etc.-->
                    {{range .Periods}}
                    <option value="{{.Value}}" {{.Selected}}>{{.DisplayName}}</option>
                    {{end}}
                </select>
            </div>

            <!-- Year Range -->
            <div class="grid grid-cols-3 gap-3 items-center">
                <label for="from_year" class="col-span-1 font-medium">Year Range</label>
                <div class="col-span-2 grid grid-cols-2 gap-3">
                    <input type="number" id="from_year" name="from_year" placeholder="From" value="{{.Query.from_year}}"
                        class="border rounded p-2 w-full">
                    <input type="number" id="to_year" name="to_year" placeholder="To" value="{{.Query.to_year}}"
                        class="border rounded p-2 w-full">
                </div>
            </div>
        </form>

        <!-- Summary -->
        <div>
            <div id="station-summary-container" hx-ext="path-params" hx-include="#chart-controls" hx-swap="innerHTML"
                hx-trigger="change from:#station, change from:#period, change from:#from_year, change from:#to_year"
                hx-get="/stations/{station}/summary">
                <!-- <table> with station weather summary goes here -->
                <!-- #include "../templates/station_summary.html" -->
            </div>
        </div>


        <!-- Charts -->
        <div>
            <div class="mb-8">
                <div id="raindays-chart-script-container" hx-ext="path-params" hx-include="#chart-controls"
                    hx-swap="innerHTML" hx-trigger="change from:#chart-controls"
                    hx-get="/stations/{station}/charts/annual/raindays">
                    <!-- <script> element with Vega from the backend goes here. -->
                </div>
                <!-- ‘overflow-hidden’ keeps stray pixels inside; w‑full lets Vega stretch -->
                <div id="raindays-chart" class="w-full overflow-hidden">
                    <!-- Under Vega's control. Chart goes here. -->
                </div>
            </div>
            <div class="mb-8">
                <div id="sunny_days-chart-script-container" hx-ext="path-params" hx-include="#chart-controls"
                    hx-swap="innerHTML" hx-trigger="change from:#chart-controls"
                    hx-get="/stations/{station}/charts/annual/sunny_days">
                    <!-- <script> element with Vega from the backend goes here. -->
                </div>
                <!-- ‘overflow-hidden’ keeps stray pixels inside; w‑full lets Vega stretch -->
                <div id="sunny_days-chart" class="w-full overflow-hidden">
                    <!-- Under Vega's control. Chart goes here. -->
                </div>
            </div>
            <div class="mb-8">
                <div id="summer_days-chart-script-container" hx-ext="path-params" hx-include="#chart-controls"
                    hx-swap="innerHTML" hx-trigger="change from:#chart-controls"
                    hx-get="/stations/{station}/charts/annual/summer_days">
                    <!-- <script> element with Vega from the backend goes here. -->
                </div>
                <!-- ‘overflow-hidden’ keeps stray pixels inside; w‑full lets Vega stretch -->
                <div id="summer_days-chart" class="w-full overflow-hidden">
                    <!-- Under Vega's control. Chart goes here. -->
                </div>
            </div>
            <div class="mb-8">
                <div id="frost_days-chart-script-container" hx-ext="path-params" hx-include="#chart-controls"
                    hx-swap="innerHTML" hx-trigger="change from:#chart-controls"
                    hx-get="/stations/{station}/charts/annual/frost_days">
                    <!-- <script> element with Vega from the backend goes here. -->
                </div>
                <!-- ‘overflow-hidden’ keeps stray pixels inside; w‑full lets Vega stretch -->
                <div id="frost_days-chart" class="w-full overflow-hidden">
                    <!-- Under Vega's control. Chart goes here. -->
                </div>
            </div>
            <div class="mb-8">
                <div id="sunshine-chart-script-container" hx-ext="path-params" hx-include="#chart-controls"
                    hx-swap="innerHTML" hx-trigger="change from:#chart-controls"
                    hx-get="/stations/{station}/charts/annual/sunshine">
                    <!-- <script> element with Vega from the backend goes here. -->
                </div>
                <!-- ‘overflow-hidden’ keeps stray pixels inside; w‑full lets Vega stretch -->
                <div id="sunshine-chart" class="w-full overflow-hidden">
                    <!-- Under Vega's control. Chart goes here. -->
                </div>
            </div>
            <div class="mb-8">
                <div id="rainiest_day-chart-script-container" hx-ext="path-params" hx-include="#chart-controls"
                    hx-swap="innerHTML" hx-trigger="change from:#chart-controls"
                    hx-get="/stations/{station}/charts/annual/rainiest_day">
                    <!-- <script> element with Vega from the backend goes here. -->
                </div>
                <!-- ‘overflow-hidden’ keeps stray pixels inside; w‑full lets Vega stretch -->
                <div id="rainiest_day-chart" class="w-full overflow-hidden">
                    <!-- Under Vega's control. Chart goes here. -->
                </div>
            </div>
        </div>
    </main>

    {{template "disclaimer.html" .}}

    <script type="module" src="/static/dist/main.js"></script>

</body>

</html>