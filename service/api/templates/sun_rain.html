<!DOCTYPE html>
<html lang="en">

<head>
    {{ template "head.html" }}
</head>

<body class="min-h-screen bg-gray-50 p-4" data-page="sun_rain">
    <!-- Navbar -->
    {{template "nav.html" .}}

    <main class="w-full max-w-screen-lg mx-auto space-y-6 bg-white shadow rounded-xl p-6">
        <h1 class="text-2xl font-semibold text-center">Sunshine &amp; Rain</h1>


        <div class="space-y-3">
            <!-- Search (locations or postal codes) -->
            <div class="grid grid-cols-3 gap-3 items-start">
                <label for="station-search" class="col-span-1 font-medium pt-2">Search</label>

                <div class="col-span-2">
                    <div class="flex items-center gap-2">
                        <input id="station-search" name="q" type="search" placeholder="'3001' or 'Bern'"
                            class="border rounded p-2 w-full" autocomplete="off" spellcheck="false"
                            hx-get="/stations/search" hx-trigger="input changed delay:400ms, search"
                            hx-target="#search-results" />
                    </div>
                    <div id="search-results"></div>
                </div>
            </div>
            <!-- Controls -->
            <form class="space-y-4" id="chart-controls">

                <!-- Station -->
                <div class="grid grid-cols-3 gap-3 items-start">
                    <label for="station" class="col-span-1 font-medium pt-2">Station</label>

                    <select id="station" name="station" class="col-span-2 border rounded p-2 w-full">
                        {{$selected := .Query.station}}
                        {{range .Stations}}
                        <option value="{{.Abbr}}" {{if eq .Abbr $selected}}selected{{end}}>{{.Name}} {{.Canton}}
                            ({{.Abbr}})
                        </option>
                        {{end}}
                    </select>
                </div>

                <!-- Period -->
                <div class="grid grid-cols-3 gap-3 items-start">
                    <label for="period" class="col-span-1 font-medium pt-2">Period</label>

                    <select id="period" name="period" class="col-span-2 border rounded p-2 w-full">
                        <!-- Jan Feb Mar ... Spring Summer etc.-->
                        {{range .Periods}}
                        <option value="{{.Value}}" {{.Selected}}>{{.DisplayName}}</option>
                        {{end}}
                    </select>
                </div>

                <!-- Year Range -->
                <div class="grid grid-cols-3 gap-3 items-start">
                    <label for="from_year" class="col-span-1 font-medium pt-2">Year Range</label>
                    <div class="col-span-2 grid grid-cols-2 gap-3">
                        <input type="number" id="from_year" name="from_year" placeholder="From"
                            value="{{.Query.from_year}}" class="border rounded p-2 w-full">
                        <input type="number" id="to_year" name="to_year" placeholder="To" value="{{.Query.to_year}}"
                            class="border rounded p-2 w-full">
                    </div>
                </div>
            </form>
        </div>

        <!-- Charts -->
        <div>

            <h2 class="text-lg font-medium text-gray-800 mt-6 mb-2">Sunny days</h2>
            <p class="text-sm text-gray-600 leading-relaxed mb-4">
                Number of sunny days, i.e. days with &geq; 6 hours of sunshine,
                for each year during the selected period.
            </p>
            <div class="mb-8">
                <div hx-ext="path-params" hx-include="#chart-controls" hx-swap="innerHTML"
                    hx-trigger="change from:#chart-controls" hx-get="/stations/{station}/charts/annual/sunny_days"
                    data-vega-target="sunny-days-chart">
                    <!-- <script> element with Vega from the backend goes here. -->
                </div>
                <!-- ‘overflow-hidden’ keeps stray pixels inside; w‑full lets Vega stretch -->
                <div id="sunny-days-chart" class="w-full overflow-hidden">
                    <!-- Under Vega's control. Chart goes here. -->
                </div>
            </div>

            <h2 class="text-lg font-medium text-gray-800 mt-6 mb-2">Summer days</h2>
            <p class="text-sm text-gray-600 leading-relaxed mb-4">
                Number of summer days, i.e. days with a maximum temperature of &geq; 25 &deg;C
                for each year during the selected period.
            </p>
            <div class="mb-8">
                <div hx-ext="path-params" hx-include="#chart-controls" hx-swap="innerHTML"
                    hx-trigger="change from:#chart-controls" hx-get="/stations/{station}/charts/annual/summer_days"
                    data-vega-target="summer-days-chart">
                    <!-- <script> element with Vega from the backend goes here. -->
                </div>
                <!-- ‘overflow-hidden’ keeps stray pixels inside; w‑full lets Vega stretch -->
                <div id="summer-days-chart" class="w-full overflow-hidden">
                    <!-- Under Vega's control. Chart goes here. -->
                </div>
            </div>

            <h2 class="text-lg font-medium text-gray-800 mt-6 mb-2">Sunshine duration</h2>
            <p class="text-sm text-gray-600 leading-relaxed mb-4">
                Total duration of sunshine for each year during the selected period.
            </p>
            <div class="mb-8">
                <div hx-ext="path-params" hx-include="#chart-controls" hx-swap="innerHTML"
                    hx-trigger="change from:#chart-controls" hx-get="/stations/{station}/charts/annual/sunshine"
                    data-vega-target="sunshine-chart">
                    <!-- <script> element with Vega from the backend goes here. -->
                </div>
                <!-- ‘overflow-hidden’ keeps stray pixels inside; w‑full lets Vega stretch -->
                <div id="sunshine-chart" class="w-full overflow-hidden">
                    <!-- Under Vega's control. Chart goes here. -->
                </div>
            </div>

            <h2 class="text-lg font-medium text-gray-800 mt-6 mb-2">Frost days</h2>
            <p class="text-sm text-gray-600 leading-relaxed mb-4">
                Number of frost days, i.e. days with a minimum temperature of &lt; 0 &deg;C
                for each year during the selected period.
            </p>
            <div class="mb-8">
                <div hx-ext="path-params" hx-include="#chart-controls" hx-swap="innerHTML"
                    hx-trigger="change from:#chart-controls" hx-get="/stations/{station}/charts/annual/frost_days"
                    data-vega-target="frost-days-chart">
                    <!-- <script> element with Vega from the backend goes here. -->
                </div>
                <!-- ‘overflow-hidden’ keeps stray pixels inside; w‑full lets Vega stretch -->
                <div id="frost-days-chart" class="w-full overflow-hidden">
                    <!-- Under Vega's control. Chart goes here. -->
                </div>
            </div>

            <h2 class="text-lg font-medium text-gray-800 mt-6 mb-2">Rain days</h2>
            <p class="text-sm text-gray-600 leading-relaxed mb-4">
                Number of rain days, i.e. days with &geq; 1 mm total precipitation,
                for each year during the selected period.
            </p>
            <div class="mb-8">
                <div hx-ext="path-params" hx-include="#chart-controls" hx-swap="innerHTML"
                    hx-trigger="change from:#chart-controls" hx-get="/stations/{station}/charts/annual/raindays"
                    data-vega-target="raindays-chart">
                    <!-- <script> element with Vega from the backend goes here. -->
                </div>
                <!-- ‘overflow-hidden’ keeps stray pixels inside; w‑full lets Vega stretch -->
                <div id="raindays-chart" class="w-full overflow-hidden">
                    <!-- Under Vega's control. Chart goes here. -->
                </div>
            </div>

            <h2 class="text-lg font-medium text-gray-800 mt-6 mb-2">Max. daily rain</h2>
            <p class="text-sm text-gray-600 leading-relaxed mb-4">
                Maximum rainfall on any given day of the selected period, by year.
            </p>
            <div class="mb-8">
                <div hx-ext="path-params" hx-include="#chart-controls" hx-swap="innerHTML"
                    hx-trigger="change from:#chart-controls" hx-get="/stations/{station}/charts/annual/rainiest_day"
                    data-vega-target="rainiest-day-chart">
                    <!-- <script> element with Vega from the backend goes here. -->
                </div>
                <!-- ‘overflow-hidden’ keeps stray pixels inside; w‑full lets Vega stretch -->
                <div id="rainiest-day-chart" class="w-full overflow-hidden">
                    <!-- Under Vega's control. Chart goes here. -->
                </div>
            </div>
        </div>
    </main>

    <footer>
        {{template "disclaimer.html" .}}
    </footer>

    <script type="module" src='{{assetHash "/static/dist/main.js"}}'></script>

</body>

</html>