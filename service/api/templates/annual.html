<!DOCTYPE html>
<html lang="en">

<head>
    {{ template "head.html" }}
</head>

<body class="min-h-screen bg-gray-50 p-4" data-page="annual">
    <!-- Navbar -->
    {{template "nav.html" .}}

    <main class="w-full max-w-screen-lg mx-auto space-y-6 bg-white shadow rounded-xl p-6">
        <h1 class="text-2xl font-semibold text-center">Annual Time Series</h1>
        <div class="space-y-3">
            <p class="text-sm text-gray-700 leading-relaxed p-2 bg-[#eaf2fa] border border-[#d1e6f5] rounded-lg">
                This page displays data from MeteoSwiss's automatic and manual
                <a class="text-blue-600 hover:underline" href="https://opendatadocs.meteoswiss.ch/a-data-groundbased"
                    target="_blank">
                    weather stations
                </a>
                The data has not been homogenised, so measurements from different years may not be directly comparable
                and should not be used to draw conclusions about long-term climate trends.
            </p>
        </div>

        <div class="space-y-3">
            <!-- Search (locations or postal codes) -->
            <div class="grid grid-cols-3 gap-3 items-start">
                <label for="station-search" class="col-span-1 font-medium pt-2">Search</label>

                <div class="col-span-2">
                    <div class="flex items-center gap-2">
                        <input id="station-search" name="q" type="search" placeholder="'3004' or 'Bern'"
                            class="border rounded p-2 w-full" autocomplete="off" spellcheck="false"
                            hx-get="/stations/search" hx-trigger="input changed delay:400ms, search"
                            hx-target="#search-results" />
                    </div>
                    <div id="search-results"></div>
                </div>
            </div>
            <!-- Controls -->
            <form class="space-y-4" id="chart-controls">

                <!-- Station -->
                <div class="grid grid-cols-3 gap-3 items-start">
                    <label for="station" class="col-span-1 font-medium pt-2">Station</label>

                    <select id="station" name="station" class="col-span-2 border rounded p-2 w-full">
                        {{$selected := .Query.station}}
                        {{range .Stations}}
                        <option value="{{.Abbr}}" {{if eq .Abbr $selected}}selected{{end}}>{{.Name}} {{.Canton}}
                            ({{.Abbr}})
                        </option>
                        {{end}}
                    </select>
                </div>

                <!-- Period -->
                <div class="grid grid-cols-3 gap-3 items-start">
                    <label for="period" class="col-span-1 font-medium pt-2">Period</label>

                    <select id="period" name="period" class="col-span-2 border rounded p-2 w-full">
                        <!-- Jan Feb Mar ... Spring Summer etc.-->
                        {{range .Periods}}
                        <option value="{{.Value}}" {{.Selected}}>{{.DisplayName}}</option>
                        {{end}}
                    </select>
                </div>

                <!-- Year Range -->
                <div class="grid grid-cols-3 gap-3 items-start">
                    <label for="from_year" class="col-span-1 font-medium pt-2">Year Range</label>
                    <div class="col-span-2 grid grid-cols-2 gap-3">
                        <input type="number" id="from_year" name="from_year" placeholder="From"
                            value="{{.Query.from_year}}" class="border rounded p-2 w-full">
                        <input type="number" id="to_year" name="to_year" placeholder="To" value="{{.Query.to_year}}"
                            class="border rounded p-2 w-full">
                    </div>
                </div>
            </form>
        </div>

        <!-- Charts -->
        <div>

            <h2 class="text-lg font-medium text-gray-800 mt-6 mb-2">Sunshine</h2>
            <p class="text-sm text-gray-600 leading-relaxed mb-4">
                Number of sunny days, i.e. days with &geq; 6 hours of sunshine,
                and daily sunshine duration
                for each year during the selected period.
            </p>

            <div class="tab-widget mb-12">
                <div role="tablist" class="flex gap-2 mb-4 border-b border-gray-200">
                    <!-- Sunny days -->
                    <button data-chart-type="sunny_days" role="tab" aria-selected="true" class="px-3 py-2 text-sm font-medium border-b-2 border-transparent text-gray-600
                   hover:text-gray-800 focus:outline-none
                   aria-selected:border-blue-600 aria-selected:text-blue-600">
                        Sunny days
                    </button>
                    <!-- Sunshine hours -->
                    <button data-chart-type="sunshine" role="tab" aria-selected="false" class="px-3 py-2 text-sm font-medium border-b-2 border-transparent text-gray-600
                   hover:text-gray-800 focus:outline-none
                   aria-selected:border-blue-600 aria-selected:text-blue-600">
                        Sunshine hours
                    </button>
                </div>

                <div class="vega-spec-loader" data-vega-target="sun-vega-chart"
                    hx-get="/stations/{station}/charts/annual/{chartType}" hx-ext="path-params"
                    hx-trigger="change from:#chart-controls, refresh" hx-include="#chart-controls"
                    hx-vals='{"chartType":"sunny_days"}' hx-target="this" hx-swap="innerHTML"></div>
                <div id="sun-vega-chart" class="w-full overflow-hidden"></div>
            </div>


            <h2 class="text-lg font-medium text-gray-800 mt-6 mb-2">Special temperature days</h2>
            <p class="text-sm text-gray-600 leading-relaxed mb-4">
                Number of summer days (maximum temperature &geq; 25 &deg;C)
                and frost days (minimum temperature &lt; 0 &deg;C)
                for each year during the selected period.
            </p>

            <div class="tab-widget mb-12">
                <div role="tablist" class="flex gap-2 mb-4 border-b border-gray-200">
                    <!-- Summer days -->
                    <button data-chart-type="summer_days" role="tab" aria-selected="true" class="px-3 py-2 text-sm font-medium border-b-2 border-transparent text-gray-600
                   hover:text-gray-800 focus:outline-none
                   aria-selected:border-blue-600 aria-selected:text-blue-600">
                        Summer days
                    </button>
                    <!-- Frost days -->
                    <button data-chart-type="frost_days" role="tab" aria-selected="false" class="px-3 py-2 text-sm font-medium border-b-2 border-transparent text-gray-600
                   hover:text-gray-800 focus:outline-none
                   aria-selected:border-blue-600 aria-selected:text-blue-600">
                        Frost days
                    </button>
                </div>

                <div class="vega-spec-loader" data-vega-target="seasondays-vega-chart"
                    hx-get="/stations/{station}/charts/annual/{chartType}" hx-ext="path-params"
                    hx-trigger="change from:#chart-controls, refresh" hx-include="#chart-controls"
                    hx-vals='{"chartType":"summer_days"}' hx-target="this" hx-swap="innerHTML"></div>
                <div id="seasondays-vega-chart" class="w-full overflow-hidden"></div>
            </div>



            <h2 class="text-lg font-medium text-gray-800 mt-6 mb-2">Precipitation</h2>
            <p class="text-sm text-gray-600 leading-relaxed mb-4">
                Number of rain days, i.e. days with &geq; 1 mm total precipitation,
                and maximum rainfall on a single
                day, for each year during the selected period.
            </p>


            <div class="tab-widget mb-12">
                <div role="tablist" class="flex gap-2 mb-4 border-b border-gray-200">
                    <!-- Rain days -->
                    <button data-chart-type="raindays" role="tab" aria-selected="true" class="px-3 py-2 text-sm font-medium border-b-2 border-transparent text-gray-600
                   hover:text-gray-800 focus:outline-none
                   aria-selected:border-blue-600 aria-selected:text-blue-600">
                        Rain days
                    </button>
                    <!-- Max. daily rain -->
                    <button data-chart-type="rainiest_day" role="tab" aria-selected="false" class="px-3 py-2 text-sm font-medium border-b-2 border-transparent text-gray-600
                   hover:text-gray-800 focus:outline-none
                   aria-selected:border-blue-600 aria-selected:text-blue-600">
                        Max. daily rain
                    </button>
                </div>

                <div class="vega-spec-loader" data-vega-target="precipitation-vega-chart"
                    hx-get="/stations/{station}/charts/annual/{chartType}" hx-ext="path-params"
                    hx-trigger="change from:#chart-controls, refresh" hx-include="#chart-controls"
                    hx-vals='{"chartType":"raindays"}' hx-target="this" hx-swap="innerHTML"></div>
                <div id="precipitation-vega-chart" class="w-full overflow-hidden"></div>
            </div>


            <h2 class="text-lg font-medium text-gray-800 mt-6 mb-2">Snow</h2>
            <p class="text-sm text-gray-600 leading-relaxed mb-4">
                Number of snow days, i.e. days with &geq; 1 cm total snow depth,
                and maximum snow depth on a single
                day, for each year during the selected period.
            </p>


            <div class="tab-widget mb-12">
                <div role="tablist" class="flex gap-2 mb-4 border-b border-gray-200">
                    <!-- Max. snow height -->
                    <button data-chart-type="max_snow_height" role="tab" aria-selected="true" class="px-3 py-2 text-sm font-medium border-b-2 border-transparent text-gray-600
                   hover:text-gray-800 focus:outline-none
                   aria-selected:border-blue-600 aria-selected:text-blue-600">
                        Max. snow height
                    </button>
                    <!-- Snow days -->
                    <button data-chart-type="snow_days" role="tab" aria-selected="false" class="px-3 py-2 text-sm font-medium border-b-2 border-transparent text-gray-600
                   hover:text-gray-800 focus:outline-none
                   aria-selected:border-blue-600 aria-selected:text-blue-600">
                        Snow days
                    </button>
                    <!-- Snow days -->
                    <button data-chart-type="max_fresh_snow" role="tab" aria-selected="false" class="px-3 py-2 text-sm font-medium border-b-2 border-transparent text-gray-600
                   hover:text-gray-800 focus:outline-none
                   aria-selected:border-blue-600 aria-selected:text-blue-600">
                        Fresh snow
                    </button>
                    <!-- Snow days -->
                    <button data-chart-type="fresh_snow_days" role="tab" aria-selected="false" class="px-3 py-2 text-sm font-medium border-b-2 border-transparent text-gray-600
                   hover:text-gray-800 focus:outline-none
                   aria-selected:border-blue-600 aria-selected:text-blue-600">
                        Fresh snow days
                    </button>
                </div>

                <div class="vega-spec-loader" data-vega-target="snow-vega-chart"
                    hx-get="/stations/{station}/charts/annual/{chartType}" hx-ext="path-params"
                    hx-trigger="change from:#chart-controls, refresh" hx-include="#chart-controls"
                    hx-vals='{"chartType":"max_snow_height"}' hx-target="this" hx-swap="innerHTML"></div>
                <div id="snow-vega-chart" class="w-full overflow-hidden"></div>
            </div>

        </div>
    </main>

    <footer>
        {{template "disclaimer.html" .}}
    </footer>

    <script type="module" src='{{assetHash "/static/dist/main.js"}}'></script>

</body>

</html>